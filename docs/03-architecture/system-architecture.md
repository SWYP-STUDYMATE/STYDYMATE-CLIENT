# ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

## ğŸ—ï¸ ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ì‚¬ìš©ì (Web/Mobile)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cloudflare CDN/Pages                      â”‚
â”‚                  (Static Assets & Frontend)                  â”‚
â”‚                   https://languagemate.kr                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                    â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   REST API   â”‚   â”‚  WebSocket   â”‚   â”‚  Workers AI  â”‚
â”‚   (HTTPS)    â”‚   â”‚    (WSS)     â”‚   â”‚   (HTTPS)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                   â”‚
       â–¼                  â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Cloudflare Workers API Layer                 â”‚
â”‚                  https://api.languagemate.kr                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Auth   â”‚   User   â”‚ Matching â”‚   Chat   â”‚ Sessions â”‚   â”‚
â”‚  â”‚ Routes  â”‚ Routes   â”‚ Routes   â”‚ Routes   â”‚ Routes   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚        â–² Durable Objects (WebRTC / Presence / Chat Hub)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      D1      â”‚  â”‚  Workers KV  â”‚  â”‚      R2      â”‚
â”‚  Relational  â”‚  â”‚   Cache &    â”‚  â”‚  Assets &    â”‚
â”‚   Storage    â”‚  â”‚ Configurationâ”‚  â”‚   Media      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ ì»´í¬ë„ŒíŠ¸ ìƒì„¸

### 1. Frontend (STUDYMATE-CLIENT)

#### ê¸°ìˆ  ìŠ¤íƒ
- **Framework**: React 19.1.0
- **Build Tool**: Vite 7.0.4
- **Styling**: Tailwind CSS 4.1.11
- **State Management**: Zustand 5.0.6
- **Routing**: React Router DOM 7.6.3
- **HTTP Client**: Axios 1.10.0
- **WebSocket**: SockJS + StompJS

#### ì£¼ìš” ë””ë ‰í† ë¦¬
```
src/
â”œâ”€â”€ api/           # API í†µì‹  ë ˆì´ì–´
â”œâ”€â”€ components/    # ì¬ì‚¬ìš© ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ hooks/         # ì»¤ìŠ¤í…€ í›…
â”œâ”€â”€ pages/         # í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ store/         # ìƒíƒœ ê´€ë¦¬
â”œâ”€â”€ utils/         # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â””â”€â”€ services/      # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
```

### 2. Backend (Cloudflare Workers)

#### ê¸°ìˆ  ìŠ¤íƒ
- **Framework**: Hono 4.x
- **Language**: TypeScript (Service Worker ëŸ°íƒ€ì„)
- **Data Stores**: Cloudflare D1, Workers KV, R2
- **Stateful Components**: Durable Objects (WebRTC Room, UserPresence, ChatHub)
- **Authentication**: JWT + OAuth2 Callback Routes
- **Observability**: Cloudflare Analytics, Wrangler Tail, Workers Logs

#### ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
workers/src/
â”œâ”€â”€ routes/        # REST / WebSocket í•¸ë“¤ëŸ¬ ì§‘í•©
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ users.ts
â”‚   â”œâ”€â”€ matching.ts
â”‚   â”œâ”€â”€ onboarding.ts
â”‚   â”œâ”€â”€ notifications.ts
â”‚   â””â”€â”€ ...
â”œâ”€â”€ services/      # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë° ë°ì´í„° ì ‘ê·¼
â”œâ”€â”€ middleware/    # ì¸ì¦, ë¡œê¹…, ì—ëŸ¬ ì²˜ë¦¬ ë¯¸ë“¤ì›¨ì–´
â”œâ”€â”€ durable/       # Durable Object êµ¬í˜„ (WebRTCRoom, UserPresence, ChatHub)
â”œâ”€â”€ utils/         # ê³µìš© ìœ í‹¸ë¦¬í‹°
â””â”€â”€ types/         # íƒ€ì… ì„ ì–¸ ë° ë°”ì¸ë”© ì •ì˜
```

#### ë°ì´í„° ê³„ì¸µ
- **D1**: ì‚¬ìš©ì, ë§¤ì¹­, ì•Œë¦¼, ë ˆë²¨ í…ŒìŠ¤íŠ¸ ë“± ê´€ê³„í˜• ë°ì´í„° ê´€ë¦¬
- **Workers KV**: ë§¤ì¹­ ì„¤ì •, ìºì‹œëœ ë©”íƒ€ë°ì´í„°, ì†ë„ ë¯¼ê° í‚¤-ê°’ ë°ì´í„°
- **R2**: ìŒì„±/ì´ë¯¸ì§€ ì—…ë¡œë“œ ë“± ëŒ€ìš©ëŸ‰ ê°ì²´ ì €ì¥
- **Durable Objects**: ì‹¤ì‹œê°„ ì„¸ì…˜ ìƒíƒœ ë° Presence ê´€ë¦¬

### 3. AI Service (STUDYMATE-WORKERS)

#### ê¸°ìˆ  ìŠ¤íƒ
- **Platform**: Cloudflare Workers
- **Language**: JavaScript
- **AI Models**: 
  - Llama 3.1 8B (í…ìŠ¤íŠ¸ í‰ê°€)
  - Whisper (ìŒì„± ì¸ì‹)
- **Storage**: 
  - KV (ì„¸ì…˜ ì €ì¥)
  - D1 (í‰ê°€ ê²°ê³¼)

#### API ì—”ë“œí¬ì¸íŠ¸
```
/api/v1/leveltest/
â”œâ”€â”€ voice/transcribe    # ìŒì„±â†’í…ìŠ¤íŠ¸ ë³€í™˜
â”œâ”€â”€ evaluate            # ë ˆë²¨ í‰ê°€
â””â”€â”€ feedback/realtime   # ì‹¤ì‹œê°„ í”¼ë“œë°±
```

## ğŸ”„ ë°ì´í„° í”Œë¡œìš°

### 1. ì¸ì¦ í”Œë¡œìš°
```
ì‚¬ìš©ì â†’ OAuth Provider â†’ Backend â†’ JWT ë°œê¸‰ â†’ Frontend
```

### 2. ë ˆë²¨ í…ŒìŠ¤íŠ¸ í”Œë¡œìš°
```
ìŒì„± ë…¹ìŒ â†’ Workers AI (Whisper) â†’ í…ìŠ¤íŠ¸ ë³€í™˜
â†’ Workers AI (Llama) â†’ CEFR í‰ê°€ â†’ Backend ì €ì¥
```

### 3. ì‹¤ì‹œê°„ í†µì‹  í”Œë¡œìš°
```
WebRTC (P2P) + WebSocket (ì‹œê·¸ë„ë§)
â†’ STUN/TURN ì„œë²„ â†’ í”¼ì–´ ì—°ê²°
```

## ğŸ” ë³´ì•ˆ ì•„í‚¤í…ì²˜

### 1. ì¸ì¦/ì¸ê°€
- JWT Access Token (15ë¶„)
- Refresh Token (7ì¼)
- Hono ê¸°ë°˜ JWT ë¯¸ë“¤ì›¨ì–´ + ë‚´ë¶€ í† í° ê²€ì¦ ìœ í‹¸

### 2. API ë³´ì•ˆ
- HTTPS ì „ìš©
- CORS ì„¤ì •
- Rate Limiting (Cloudflare)

### 3. ë°ì´í„° ë³´í˜¸
- ë¹„ë°€ë²ˆí˜¸: BCrypt í•´ì‹±
- ë¯¼ê° ì •ë³´: AES ì•”í˜¸í™” (D1 ì»¬ëŸ¼ ë ˆë²¨)
- ì„¸ì…˜ ìƒíƒœ: Durable Objects + JWT ì¡°í•©

## ğŸ“Š í™•ì¥ì„± ê³ ë ¤ì‚¬í•­

### 1. ìˆ˜í‰ í™•ì¥
- Workers ê¸€ë¡œë²Œ ë°°í¬ (ìë™ í™•ì¥)
- Durable Objectsë¥¼ í†µí•œ ì„¸ì…˜/Presence ê³µìœ 
- Edge ìºì‹±ìœ¼ë¡œ ì‘ë‹µ ì§€ì—° ìµœì†Œí™”

### 2. ì„±ëŠ¥ ìµœì í™”
- CDN í™œìš© (Cloudflare)
- ì´ë¯¸ì§€ ìµœì í™” (WebP)
- ìºì‹± ì „ëµ (Workers KV, Cache API)
- D1 ì¸ë±ìŠ¤ ë° ì½ê¸° ë¶„ë¦¬ ì„¤ê³„

### 3. ëª¨ë‹ˆí„°ë§
- Workers ë¡œê·¸ + wrangler tail
- Cloudflare Analytics / Request Tracing
- Sentry (í”„ëŸ°íŠ¸) & Durable Objects logging

## ğŸš€ ë°°í¬ ì•„í‚¤í…ì²˜

### 1. Frontend
- **Platform**: Cloudflare Pages
- **CI/CD**: GitHub Actions
- **Domain**: languagemate.kr

### 2. Backend
- **Platform**: Cloudflare Workers
- **Deployment**: Wrangler CLI (`npm run deploy:*`)
- **Environments**: production / staging
- **CI/CD**: GitHub Actions (wrangler publish)

### 3. Workers
- **Platform**: Cloudflare Workers
- **Deployment**: Wrangler CLI
- **Domain**: api.languagemate.kr

## ğŸ“ˆ í–¥í›„ ê³„íš

### Phase 1 (í˜„ì¬)
- [x] ê¸°ë³¸ ì¸ì¦/ì˜¨ë³´ë”©
- [x] 1:1 ì±„íŒ…/í™”ìƒí†µí™”
- [x] AI ë ˆë²¨ í…ŒìŠ¤íŠ¸

### Phase 2
- [ ] ê·¸ë£¹ ì„¸ì…˜
- [ ] ê³ ê¸‰ ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜
- [ ] í•™ìŠµ ë¶„ì„ ëŒ€ì‹œë³´ë“œ

### Phase 3
- [ ] ëª¨ë°”ì¼ ì•±
- [ ] ì˜¤í”„ë¼ì¸ ëª¨ë“œ
- [ ] ë‹¤êµ­ì–´ ì§€ì›
