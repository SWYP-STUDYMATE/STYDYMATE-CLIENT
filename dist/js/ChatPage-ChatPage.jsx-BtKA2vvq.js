import{b as e,z as t}from"./vendor-chunk-D6LsFSV7.js";import{a as s}from"./utils-vendor-chunk-Clitctyl.js";import{S as a,s as r}from"./realtime-vendor-chunk-Q-N5K1Ye.js";import{O as n,M as l,S as c}from"../assets/index-v0sFlu_2.js";import{M as o,a as i,P as d,b as m,V as u,E as x,c as h,d as g,e as f,f as p,X as j,g as y,h as w,i as N,j as v,k as b}from"./ui-vendor-chunk-CYPVLLJ1.js";import{D as I}from"./imageUtils-chunk-vrC6Wg2s.js";import"./react-vendor-chunk-CMkIwBz9.js";function k({rooms:a,onSelectRoom:r,onNewRoomCreated:n,onJoinRoom:l}){const[c,m]=e.useState(""),u=[...a].filter(e=>e.roomName.includes(c)),x=localStorage.getItem("userId"),h=async e=>{if(e.participants.some(e=>e.userId===x))r(e);else try{await async function(e){try{return(await s.post(`/api/chat/rooms/${e}/join`)).data.data}catch(t){throw t}}(e.roomId),l(),r(e)}catch(t){alert("채팅방 참여에 실패했습니다.")}};return t.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-center px-4",children:[t.jsx(o,{className:"w-5 h-5 text-gray-700 mr-2"}),t.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"Chat"})]}),t.jsx("div",{className:"px-4",children:t.jsxs("div",{className:"flex items-center bg-white rounded-xl px-4 py-2 shadow-sm",children:[t.jsx(i,{className:"w-4 h-4 text-gray-500 mr-2"}),t.jsx("input",{type:"text",placeholder:"채팅방을 검색해보세요",value:c,onChange:e=>m(e.target.value),className:"flex-1 bg-transparent focus:outline-none text-sm text-gray-700"})]})}),t.jsx("div",{className:"flex-1 px-4",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 h-full overflow-y-auto space-y-2",children:[u.length>0?u.map(e=>{const s=e.participants.some(e=>e.userId===x),a=e.participants.find(e=>e.userId!==x),r=a?a.name:e.roomName;return t.jsxs("div",{onClick:()=>h(e),className:"flex items-center p-3 hover:bg-gray-50 cursor-pointer rounded-lg border border-gray-100",children:[t.jsx("img",{src:a?.profileImage||"/assets/basicProfilePic.png",alt:"",className:"w-10 h-10 rounded-full mr-3"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium text-gray-800 truncate",children:r}),t.jsx("p",{className:"text-xs text-gray-500 truncate",children:s?e.lastMessage||"메시지가 없습니다":`참여자 ${e.participants.length}명`})]}),t.jsx("span",{className:"text-xs text-gray-400 ml-2",children:s&&e.lastMessageAt?new Date(e.lastMessageAt).toLocaleTimeString():""})]},e.roomId)}):t.jsx("div",{className:"text-center text-gray-500 py-8",children:"채팅방이 없습니다"}),t.jsxs("button",{onClick:async()=>{const e=prompt("새 채팅방 이름을 입력하세요");if(e)try{const t=await async function({roomName:e,participantIds:t}){return(await s.post("/api/chat/rooms",{roomName:e,participantIds:t})).data.data}({roomName:e,roomType:"GROUP",isPublic:!0,maxParticipants:4,participantIds:[]});r(t),n()}catch(t){alert("채팅방 생성에 실패했습니다.")}},className:"w-full mt-4 py-2 bg-[#00C471] text-white text-sm font-medium rounded-full hover:bg-[#00b364] transition-colors flex items-center justify-center",children:[t.jsx(d,{className:"w-4 h-4 mr-1"}),"새 채팅방"]})]})})]})}function S(){return t.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full",children:[t.jsx("img",{src:"/assets/nochattinghistory.png",alt:"No messages",className:"w-110 h-110 object-contain mb-4"}),t.jsx("p",{className:"text-lg font-medium text-gray-500",children:"대화 내역이 없습니다."}),t.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"새로운 대화를 시작해보세요!"})]})}function C({room:s,currentUserId:a,onLeaveRoom:r}){const[l,c]=e.useState(!1),o=e.useRef(null);s.participants.find(e=>e.userId===a);const i=s.participants.find(e=>e.userId!==a)||{name:"",profileImage:""};e.useEffect(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);return t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(n,{src:i.profileImage||I,alt:i.name,className:"w-10 h-10 rounded-full",width:40,height:40,loading:"eager"}),t.jsx("span",{className:"ml-3 text-lg font-semibold",children:s.roomName})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>{},className:"p-2 hover:bg-gray-100 rounded-full",children:t.jsx(m,{className:"w-5 h-5 text-gray-600"})}),t.jsx("button",{onClick:()=>{},className:"p-2 hover:bg-gray-100 rounded-full",children:t.jsx(u,{className:"w-5 h-5 text-gray-600"})}),t.jsxs("div",{className:"relative",ref:o,children:[t.jsx("button",{onClick:()=>c(!l),className:"p-2 hover:bg-gray-100 rounded-full",children:t.jsx(x,{className:"w-5 h-5 text-gray-600"})}),l&&t.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:t.jsxs("button",{onClick:()=>{window.confirm("정말로 이 채팅방을 나가시겠습니까?")&&r(),c(!1)},className:"w-full flex items-center px-4 py-3 text-left text-black hover:bg-gray-50 rounded-lg",children:[t.jsx(h,{className:"w-4 h-4 mr-3"}),"채팅방 나가기"]})})]})]})]})}function R({audioUrl:s,duration:a,isMine:r}){const[n,l]=e.useState(!1),[c,o]=e.useState(0),[i,d]=e.useState(a||0),[m,u]=e.useState([]),x=e.useRef(null);e.useRef(null),e.useEffect(()=>{const e=Array.from({length:40},()=>.8*Math.random()+.2);u(e)},[]),e.useEffect(()=>{const e=x.current;if(!e)return;const t=()=>{d(e.duration)},s=()=>{o(e.currentTime)},a=()=>{l(!1),o(0)};return e.addEventListener("loadedmetadata",t),e.addEventListener("timeupdate",s),e.addEventListener("ended",a),()=>{e.removeEventListener("loadedmetadata",t),e.removeEventListener("timeupdate",s),e.removeEventListener("ended",a)}},[]);const h=e=>{if(!e||isNaN(e))return"0:00";return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`},j=i?c/i*100:0;return t.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg ${r?"bg-[#00C471]":"bg-[#FFE4EC]"} min-w-[280px] max-w-[320px]`,children:[t.jsx("button",{onClick:()=>{const e=x.current;e&&(n?(e.pause(),l(!1)):(e.play(),l(!0)))},className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${r?"bg-white/20 hover:bg-white/30 text-white":"bg-gray-800/10 hover:bg-gray-800/20 text-gray-800"} transition-colors`,children:n?t.jsx(g,{className:"w-5 h-5"}):t.jsx(f,{className:"w-5 h-5 ml-0.5"})}),t.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[t.jsx("div",{className:"relative h-10 flex items-center cursor-pointer",onClick:e=>{const t=x.current;if(!t||!i)return;const s=e.currentTarget.getBoundingClientRect(),a=(e.clientX-s.left)/s.width*i;t.currentTime=a,o(a)},children:t.jsx("div",{className:"absolute inset-0 flex items-center gap-[2px]",children:m.map((e,s)=>{const a=s/m.length*100<=j;return t.jsx("div",{className:"flex-1 rounded-full transition-all duration-75 "+(r?a?"bg-white":"bg-white/40":a?"bg-gray-800":"bg-gray-800/30"),style:{height:100*e+"%"}},s)})})}),t.jsxs("div",{className:"flex items-center justify-between text-xs "+(r?"text-white/80":"text-gray-600"),children:[t.jsx("span",{children:h(c)}),t.jsx("span",{children:h(i)})]})]}),t.jsx("div",{className:"flex-shrink-0 "+(r?"text-white/60":"text-gray-600"),children:t.jsx(p,{className:"w-4 h-4"})}),t.jsx("audio",{ref:x,src:s,preload:"metadata",crossOrigin:"anonymous"})]})}function U({messages:s,currentUserId:a,formatTimestamp:r}){const n=e.useRef();return e.useEffect(()=>{setTimeout(()=>{n.current?.scrollTo(0,n.current.scrollHeight)},50)},[s]),t.jsx("div",{ref:n,className:"flex-1 min-h-0 overflow-y-auto space-y-2 p-4",children:0===s.length?t.jsx(S,{}):s.map((e,n)=>{const l=String(e.sender.userId)===String(a),c=s[n-1],o=!(c&&String(c.sender.userId)===String(e.sender.userId));return s.length,t.jsxs("div",{className:"flex items-end "+(l?"justify-end":"justify-start"),children:[!l&&t.jsxs("div",{className:"flex flex-col w-full",children:[o&&t.jsxs("div",{className:"flex items-center mb-1",children:[t.jsx("img",{src:e.sender.profileImage||"/assets/basicProfilePic.png",alt:e.sender.name,className:"w-8 h-8 rounded-full mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.sender.name})]}),t.jsx("div",{className:"flex items-end ml-10",children:t.jsxs("div",{className:"flex items-end",children:["IMAGE"===e.messageType&&e.imageUrls&&e.imageUrls.length>0?t.jsx("div",{className:"flex flex-wrap gap-1",children:e.imageUrls.map((e,s)=>t.jsx("img",{src:e,alt:"채팅 이미지",className:"max-w-xs max-h-xs h-auto rounded-lg object-contain"},s))}):"AUDIO"===e.messageType&&e.audioUrl?t.jsx(R,{audioUrl:e.audioUrl,duration:e.audioDuration,isMine:!1}):t.jsx("div",{className:"bg-pink-200 text-gray-900 px-4 py-2 rounded-lg rounded-tl-none whitespace-pre-wrap",children:e.message}),t.jsx("span",{className:"ml-2 text-xs text-gray-400 mb-1",children:r(e.sentAt)})]})})]}),l&&t.jsxs("div",{className:"flex items-end w-full justify-end",children:[t.jsx("div",{className:"flex flex-col max-w-[70%] items-end",children:t.jsxs("div",{className:"flex items-end",children:[t.jsx("span",{className:"mr-2 text-xs text-gray-400 mb-1",children:r(e.sentAt)}),"IMAGE"===e.messageType&&e.imageUrls&&e.imageUrls.length>0?t.jsx("div",{className:"flex flex-wrap gap-1",children:e.imageUrls.map((e,s)=>t.jsx("img",{src:e,alt:"채팅 이미지",className:"max-w-xs max-h-xs h-auto rounded-lg object-contain"},s))}):"AUDIO"===e.messageType&&e.audioUrl?t.jsx(R,{audioUrl:e.audioUrl,duration:e.audioDuration,isMine:!0}):t.jsx("div",{className:"bg-[#00C471] text-white px-4 py-2 rounded-lg rounded-tr-none whitespace-pre-wrap",children:e.message})]})}),t.jsx("div",{className:"w-10 flex-shrink-0 ml-2",children:o&&t.jsx("img",{src:e.sender.profileImage||"/assets/basicProfilePic.png",alt:e.sender.name,className:"w-8 h-8 rounded-full"})})]})]},e.messageId)})})}function A({onSend:s,onCancel:a}){const[r,n]=e.useState(!1),[l,c]=e.useState(0),[o,i]=e.useState(null),[d,m]=e.useState(!1),[u,x]=e.useState(Array(20).fill(.2)),h=e.useRef(null),g=e.useRef([]),f=e.useRef(null),N=e.useRef(null),v=e.useRef(null),b=e.useRef(null),I=e.useRef(null),k=e.useRef(null);e.useEffect(()=>()=>{N.current&&N.current.getTracks().forEach(e=>e.stop()),f.current&&clearInterval(f.current),k.current&&cancelAnimationFrame(k.current),b.current&&b.current.close()},[]);const S=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});N.current=e,b.current=new(window.AudioContext||window.webkitAudioContext);const t=b.current.createMediaStreamSource(e);I.current=b.current.createAnalyser(),I.current.fftSize=64,t.connect(I.current);const s=["audio/webm;codecs=opus","audio/ogg;codecs=opus","audio/webm","audio/mp4"].find(e=>MediaRecorder.isTypeSupported(e));if(!s)return void alert("브라우저가 음성 녹음을 지원하지 않습니다.");const a=new MediaRecorder(e,{mimeType:s});h.current=a,g.current=[],a.ondataavailable=e=>{e.data.size>0&&g.current.push(e.data)},a.onstop=()=>{const e=new Blob(g.current,{type:s});i(e),k.current&&cancelAnimationFrame(k.current)},a.start(),n(!0),c(0),f.current=setInterval(()=>{c(e=>e+1)},1e3),C()}catch(e){alert("마이크 권한을 허용해주세요.")}},C=()=>{if(!I.current||!r)return;const e=new Uint8Array(I.current.frequencyBinCount);I.current.getByteFrequencyData(e);const t=[],s=Math.floor(e.length/20);for(let a=0;a<20;a++){let r=0;for(let t=0;t<s;t++)r+=e[a*s+t];const n=r/s/255;t.push(Math.max(.2,n))}x(t),k.current=requestAnimationFrame(C)},R=()=>{h.current&&"recording"===h.current.state&&(h.current.stop(),n(!1),f.current&&clearInterval(f.current),N.current&&N.current.getTracks().forEach(e=>e.stop()))};return t.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-50",children:t.jsxs("div",{className:"max-w-2xl mx-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"음성 메시지"}),t.jsx("button",{onClick:()=>{r&&R(),i(null),c(0),x(Array(20).fill(.2)),a()},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:t.jsx(j,{className:"w-5 h-5 text-gray-500"})})]}),t.jsxs("div",{className:"bg-gray-100 rounded-lg p-6 mb-4",children:[t.jsx("div",{className:"flex items-center justify-center gap-1 h-16",children:u.map((e,s)=>t.jsx("div",{className:"w-1 bg-gradient-to-t rounded-full transition-all duration-150 "+(r?"from-red-500 to-red-400":o?"from-[#00C471] to-[#00A85F]":"from-gray-400 to-gray-300"),style:{height:100*e+"%",minHeight:"20%"}},s))}),t.jsx("div",{className:"text-center mt-2",children:t.jsx("span",{className:"text-2xl font-mono "+(r?"text-red-500":"text-gray-700"),children:(U=l,`${Math.floor(U/60)}:${(U%60).toString().padStart(2,"0")}`)})})]}),t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[!r&&!o&&t.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-6 py-3 bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors",children:[t.jsx(p,{className:"w-5 h-5"}),t.jsx("span",{children:"녹음 시작"})]}),r&&t.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-6 py-3 bg-gray-800 hover:bg-gray-900 text-white rounded-full transition-colors",children:[t.jsx(y,{className:"w-5 h-5"}),t.jsx("span",{children:"녹음 중지"})]}),o&&!r&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:S,className:"p-3 bg-gray-200 hover:bg-gray-300 rounded-full transition-colors",title:"다시 녹음",children:t.jsx(p,{className:"w-5 h-5 text-gray-700"})}),t.jsx("button",{onClick:()=>{if(o&&v.current){const e=URL.createObjectURL(o);v.current.src=e,v.current.play(),m(!0),v.current.onended=()=>{m(!1)}}},className:"px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-full transition-colors",children:d?"재생 중...":"미리 듣기"}),t.jsxs("button",{onClick:()=>{if(o){const e=new FileReader;e.onloadend=()=>{s(e.result)},e.readAsDataURL(o)}},className:"flex items-center gap-2 px-6 py-3 bg-[#00C471] hover:bg-[#00B267] text-white rounded-full transition-colors",children:[t.jsx(w,{className:"w-5 h-5"}),t.jsx("span",{children:"전송"})]})]})]}),t.jsx("audio",{ref:v})]})});var U}function E({input:s,setInput:a,sendMessage:r,showEmojiPicker:n,setShowEmojiPicker:l,selectedImageFiles:c,imagePreviews:o,handleFileChange:i,removeImagePreview:d,fileInputRef:m}){const[u,x]=e.useState(!1);return t.jsxs("div",{className:"mt-4 flex flex-col px-4",children:[n&&t.jsx("div",{className:"mb-2",children:t.jsx(N,{onEmojiClick:e=>{a(t=>t+e.emoji),l(!1)}})}),o.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 mb-2 p-2 border rounded-lg bg-gray-50",children:o.map((e,s)=>t.jsxs("div",{className:"relative w-20 h-20 rounded-lg overflow-hidden",children:[t.jsx("img",{src:e,alt:"preview",className:"w-full h-full object-cover"}),t.jsx("button",{onClick:()=>d(s),className:"absolute top-0.5 right-0.5 bg-black bg-opacity-50 text-white rounded-full p-0.5",children:t.jsx(j,{size:12})})]},s))}),t.jsxs("div",{className:"flex items-center",children:[t.jsxs("div",{className:"relative flex-1 flex items-center bg-gray-100 rounded-lg px-4 py-2",children:[t.jsx(v,{className:"w-5 h-5 text-gray-500 mr-2 cursor-pointer",onClick:()=>m.current.click()}),t.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:i,ref:m,className:"hidden"}),t.jsx("input",{type:"text",value:s,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),r(s,c,null),a(""))},placeholder:"Type your message",className:"flex-1 bg-transparent outline-none"}),t.jsx("button",{onClick:()=>l(e=>!e),className:"ml-2",children:t.jsx(b,{className:"w-5 h-5 text-gray-500"})})]}),t.jsx("button",{onClick:()=>x(!0),className:"ml-4 p-3 rounded-lg bg-blue-500 hover:bg-blue-600 text-white transition-colors",children:t.jsx(p,{className:"w-5 h-5"})})]}),u&&t.jsx(A,{onSend:e=>{r("",[],e),x(!1)},onCancel:()=>x(!1)})]})}function M({room:n,onNewMessage:l,currentUserId:c,onLeaveRoom:o}){if(!n)return null;const[i,d]=e.useState([]),[m,u]=e.useState(""),[x,h]=e.useState(!1),[g,f]=e.useState([]),[p,j]=e.useState([]),y=e.useRef(null),w=e.useRef(null);e.useEffect(()=>(async function(e,t=0,a=50){return(await s.get(`/api/chat/rooms/${e}/messages?page=${t}&size=${a}`)).data.data}(n.roomId).then(d),y.current=function(e,t){const s=localStorage.getItem("accessToken"),n=new a(`http://localhost:8080/ws/chat?token=${s}`),l=r.over(n);return l.connect({Authorization:`Bearer ${s}`},s=>{l.subscribe(`/sub/chat/room/${e}`,e=>{t(JSON.parse(e.body))})},e=>{}),l}(n.roomId,e=>{d(t=>[...t,e]),l({roomId:n.roomId,message:e.message,sentAt:e.sentAt})}),()=>y.current.disconnect()),[n.roomId]);const N=async(e,t,a)=>{let r=[];if(t.length)try{r=await async function(e,t){const a=new FormData;return t.forEach(e=>{a.append("files",e)}),(await s.post(`/api/chat/rooms/${e}/images`,a,{headers:{"Content-Type":"multipart/form-data"}})).data.data}(n.roomId,t)}catch{return void alert("이미지 업로드 실패")}y.current.send("/pub/chat/message",{},JSON.stringify({roomId:n.roomId,message:e.trim(),imageUrls:r,audioData:a,messageType:a?"AUDIO":r.length?"IMAGE":(e.trim(),"TEXT")})),u(""),f([]),j([])};return t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 flex flex-col h-full w-full",children:[t.jsx(C,{room:n,currentUserId:c,onLeaveRoom:async()=>{try{await async function(e){try{return(await s.post(`/api/chat/rooms/${e}/leave`)).data.data}catch(t){throw t}}(n.roomId),o&&o()}catch(e){alert("채팅방 나가기에 실패했습니다.")}}}),t.jsx("div",{className:"border-b border-gray-200 mx-6 my-4"}),t.jsx(U,{messages:i,currentUserId:c,formatTimestamp:e=>{const t=new Date(e);return(new Date-t)/36e5<24?t.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1}):t.toLocaleDateString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}}),t.jsx(E,{input:m,setInput:u,sendMessage:N,showEmojiPicker:x,setShowEmojiPicker:h,selectedImageFiles:g,imagePreviews:p,handleFileChange:e=>{const t=Array.from(e.target.files);f(t),j(t.map(e=>URL.createObjectURL(e))),e.target.value=""},removeImagePreview:e=>{f(t=>t.filter((t,s)=>s!==e)),j(t=>t.filter((t,s)=>s!==e))},fileInputRef:w,handleKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),N(m,g,null))}})]})}function T(){const[n,o]=e.useState([]),[i,d]=e.useState(null),m=localStorage.getItem("userId");e.useEffect(()=>{u();const e=function(e){const t=localStorage.getItem("accessToken"),s=new a(`http://localhost:8080/ws/chat?token=${t}`),n=r.over(s);let l=0;const c=()=>{n.connect({Authorization:`Bearer ${t}`},t=>{l=0,n.subscribe("/user/queue/rooms",t=>{try{const s=JSON.parse(t.body);e(s)}catch(s){}}),n.subscribe("/sub/chat/public-rooms",t=>{try{const s=JSON.parse(t.body);e(s)}catch(s){}})},e=>{l<5&&(l++,setTimeout(()=>{c()},3e3))})};c();const o=n.disconnect;return n.disconnect=()=>{o.call(n)},n}(e=>{u(),d(null)});return()=>{e&&e.disconnect()}},[]);const u=async()=>{try{const e=await async function(){try{const e=await s.get("/api/chat/rooms");return Array.isArray(e.data.data)?e.data.data:[]}catch(e){return[]}}();o(e)}catch(e){}};return t.jsxs("div",{className:"flex flex-col h-full bg-gray-100",children:[t.jsx(l,{}),t.jsxs("div",{className:"flex flex-1 p-6 space-x-6 overflow-hidden",children:[t.jsx(c,{active:"chat"}),t.jsx("div",{className:"w-80 flex-shrink-0",children:t.jsx(k,{rooms:n,onSelectRoom:d,onNewRoomCreated:()=>{u()},onJoinRoom:()=>{u()}})}),t.jsx("div",{className:"flex-1",children:i?t.jsx(M,{room:i,currentUserId:m,onBack:()=>d(null),onNewMessage:({roomId:e,message:t,sentAt:s})=>{o(a=>a.map(a=>a.roomId===e?{...a,lastMessage:t,lastMessageAt:s}:a))},onLeaveRoom:()=>{d(null),u()}}):t.jsx(S,{})})]})]})}function L(){return t.jsx("div",{className:"h-screen",children:t.jsx(T,{})})}s.defaults.baseURL="http://localhost:8080",s.interceptors.request.use(e=>{const t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e});export{L as default};
