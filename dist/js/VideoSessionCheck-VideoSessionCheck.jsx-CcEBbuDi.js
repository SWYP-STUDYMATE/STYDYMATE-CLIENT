import{b as e,z as s}from"./vendor-chunk-D6LsFSV7.js";import{C as t}from"./CommonButton-chunk-BGn4hO1n.js";import{J as a,K as c,N as l,f as r,t as i,u as n,W as d,y as o,l as x,m as u,L as m}from"./ui-vendor-chunk-CYPVLLJ1.js";import{u as h}from"./react-vendor-chunk-CMkIwBz9.js";function v(){const v=h(),[b,j]=e.useState("idle"),[f,g]=e.useState("idle"),[p,w]=e.useState("idle"),[N,k]=e.useState("idle"),[y,C]=e.useState(0),[S,I]=e.useState(null),[T,A]=e.useState(""),[D,M]=e.useState(""),[R,F]=e.useState([]),[L,_]=e.useState([]),[q,B]=e.useState(!1),E=e.useRef(null),z=e.useRef(null),U=e.useRef(null),$=e.useRef(null),O=e.useRef(null);e.useEffect(()=>(navigator.mediaDevices.enumerateDevices().then(e=>{const s=e.filter(e=>"videoinput"===e.kind),t=e.filter(e=>"audioinput"===e.kind);F(s),_(t),s.length>0&&A(s[0].deviceId),t.length>0&&M(t[0].deviceId)}),()=>{z.current&&z.current.getTracks().forEach(e=>e.stop()),O.current&&cancelAnimationFrame(O.current),U.current&&U.current.close()}),[]);const W=()=>{if(!$.current)return;const e=new Uint8Array($.current.frequencyBinCount);$.current.getByteFrequencyData(e);const s=e.reduce((e,s)=>e+s)/e.length;C(Math.min(s/128,1)),O.current=requestAnimationFrame(W)},G=async()=>{await(async()=>{j("testing");try{z.current&&z.current.getTracks().forEach(e=>e.stop());const e=await navigator.mediaDevices.getUserMedia({video:{deviceId:T?{exact:T}:void 0,width:{ideal:1280},height:{ideal:720}},audio:!1});z.current=e,E.current&&(E.current.srcObject=e),j("success")}catch(e){j("failed")}})(),setTimeout(()=>(async()=>{g("testing");try{const e=await navigator.mediaDevices.getUserMedia({audio:{deviceId:D?{exact:D}:void 0,echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}});U.current=new(window.AudioContext||window.webkitAudioContext),$.current=U.current.createAnalyser(),U.current.createMediaStreamSource(e).connect($.current),$.current.fftSize=256,W(),setTimeout(()=>{e.getTracks().forEach(e=>e.stop()),O.current&&cancelAnimationFrame(O.current),C(0),g("success")},3e3)}catch(e){g("failed")}})(),1e3),setTimeout(()=>(async()=>{w("testing");try{const e=new(window.AudioContext||window.webkitAudioContext),s=e.createOscillator(),t=e.createGain();s.connect(t),t.connect(e.destination),s.frequency.value=440,t.gain.value=.3,s.start(),t.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),setTimeout(()=>{s.stop(),w("success")},500)}catch(e){w("failed")}})(),4500),setTimeout(()=>(async()=>{k("testing");try{const e=Date.now(),s=await fetch("https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png",{cache:"no-cache"}),t=await s.blob(),a=(Date.now()-e)/1e3,c=t.size/1048576*8/a;I(c),k(c>=2?"success":"failed")}catch(e){k("failed")}})(),5500)},J=e=>{switch(e){case"idle":default:return null;case"testing":return s.jsx(m,{className:"w-5 h-5 animate-spin text-[var(--blue)]"});case"success":return s.jsx(u,{className:"w-5 h-5 text-[var(--green-500)]"});case"failed":return s.jsx(x,{className:"w-5 h-5 text-[var(--red)]"})}},K="success"===b&&"success"===f&&"success"===p&&"success"===N;return s.jsx("div",{className:"min-h-screen page-bg flex flex-col",children:s.jsxs("div",{className:"max-w-[1024px] w-full mx-auto flex flex-col min-h-screen",children:[s.jsx("div",{className:"px-6 py-4 bg-white border-b border-[var(--black-50)]",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("button",{onClick:()=>v(-1),className:"p-2 -ml-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:s.jsx("path",{d:"M15 18L9 12L15 6",stroke:"#111111",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),s.jsx("h1",{className:"text-[18px] font-bold text-[var(--black-500)]",children:"í™”ìƒ ì„¸ì…˜ ì—°ê²° í™•ì¸"}),s.jsx("button",{onClick:()=>B(!q),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(a,{className:"w-5 h-5 text-[var(--black-300)]"})})]})}),q&&s.jsx("div",{className:"bg-white border-b border-[var(--black-50)] px-6 py-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[14px] text-[var(--black-300)] mb-2",children:"ì¹´ë©”ë¼ ì„ íƒ"}),s.jsx("select",{value:T,onChange:e=>A(e.target.value),className:"w-full px-4 py-2 border border-[var(--black-50)] rounded-lg focus:outline-none focus:border-[var(--blue)]",children:R.map(e=>s.jsx("option",{value:e.deviceId,children:e.label||`ì¹´ë©”ë¼ ${e.deviceId.slice(0,5)}`},e.deviceId))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[14px] text-[var(--black-300)] mb-2",children:"ë§ˆì´í¬ ì„ íƒ"}),s.jsx("select",{value:D,onChange:e=>M(e.target.value),className:"w-full px-4 py-2 border border-[var(--black-50)] rounded-lg focus:outline-none focus:border-[var(--blue)]",children:L.map(e=>s.jsx("option",{value:e.deviceId,children:e.label||`ë§ˆì´í¬ ${e.deviceId.slice(0,5)}`},e.deviceId))})]})]})}),s.jsx("div",{className:"flex-1 px-6 py-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-[20px] font-bold text-[var(--black-500)] mb-4",children:"ì¹´ë©”ë¼ ë¯¸ë¦¬ë³´ê¸°"}),s.jsxs("div",{className:"relative aspect-video bg-black rounded-[10px] overflow-hidden",children:[s.jsx("video",{ref:E,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),"idle"===b&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[rgba(17,17,17,0.8)]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(c,{className:"w-12 h-12 text-white mb-2 mx-auto"}),s.jsx("p",{className:"text-white",children:"ì¹´ë©”ë¼ë¥¼ ì‹œì‘í•˜ë ¤ë©´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”"})]})}),"failed"===b&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[rgba(234,67,53,0.9)]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(c,{className:"w-12 h-12 text-white mb-2 mx-auto"}),s.jsx("p",{className:"text-white",children:"ì¹´ë©”ë¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"})]})})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-[20px] font-bold text-[var(--black-500)] mb-4",children:"ì—°ê²° í…ŒìŠ¤íŠ¸"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-white rounded-[10px] p-4 border border-[var(--black-50)]",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-[rgba(234,67,53,0.1)] rounded-full flex items-center justify-center mr-3",children:s.jsx(l,{className:"w-5 h-5 text-[var(--red)]"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-[14px] font-medium text-[var(--black-500)]",children:"ì¹´ë©”ë¼"}),s.jsxs("p",{className:"text-[12px] text-[var(--black-200)]",children:["idle"===b&&"ëŒ€ê¸° ì¤‘","testing"===b&&"í…ŒìŠ¤íŠ¸ ì¤‘...","success"===b&&"ì •ìƒ ì‘ë™","failed"===b&&"ì‚¬ìš© ë¶ˆê°€"]})]})]}),J(b)]})}),s.jsxs("div",{className:"bg-white rounded-[10px] p-4 border border-[var(--black-50)]",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-[rgba(0,196,113,0.12)] rounded-full flex items-center justify-center mr-3",children:s.jsx(r,{className:"w-5 h-5 text-[var(--green-500)]"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-[14px] font-medium text-[var(--black-500)]",children:"ë§ˆì´í¬"}),s.jsxs("p",{className:"text-[12px] text-[var(--black-200)]",children:["idle"===f&&"ëŒ€ê¸° ì¤‘","testing"===f&&"3ì´ˆê°„ ë§ì”€í•´ì£¼ì„¸ìš”...","success"===f&&"ì •ìƒ ì‘ë™","failed"===f&&"ì‚¬ìš© ë¶ˆê°€"]})]})]}),J(f)]}),"testing"===f&&s.jsx("div",{className:"mt-3",children:s.jsx("div",{className:"h-2 bg-[var(--black-50)] rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-[var(--green-500)] transition-all duration-100",style:{width:100*y+"%"}})})})]}),s.jsx("div",{className:"bg-white rounded-[10px] p-4 border border-[var(--black-50)]",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-[rgba(66,133,244,0.12)] rounded-full flex items-center justify-center mr-3",children:s.jsx(i,{className:"w-5 h-5 text-[var(--blue)]"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-[14px] font-medium text-[var(--black-500)]",children:"ìŠ¤í”¼ì»¤"}),s.jsxs("p",{className:"text-[12px] text-[var(--black-200)]",children:["idle"===p&&"ëŒ€ê¸° ì¤‘","testing"===p&&"í…ŒìŠ¤íŠ¸ ìŒ ì¬ìƒ ì¤‘...","success"===p&&"ì •ìƒ ì‘ë™","failed"===p&&"ì‚¬ìš© ë¶ˆê°€"]})]})]}),J(p)]})}),s.jsx("div",{className:"bg-white rounded-[10px] p-4 border border-[var(--black-50)]",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-[rgba(255,165,0,0.12)] rounded-full flex items-center justify-center mr-3",children:"failed"===N?s.jsx(n,{className:"w-5 h-5 text-[var(--warning-yellow)]"}):s.jsx(d,{className:"w-5 h-5 text-[var(--warning-yellow)]"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-[14px] font-medium text-[var(--black-500)]",children:"ì¸í„°ë„·"}),s.jsxs("p",{className:"text-[12px] text-[var(--black-200)]",children:["idle"===N&&"ëŒ€ê¸° ì¤‘","testing"===N&&"ì†ë„ ì¸¡ì • ì¤‘...","success"===N&&`${S?.toFixed(1)} Mbps`,"failed"===N&&"ì†ë„ ë¶€ì¡±"]})]})]}),J(N)]})})]}),s.jsx("div",{className:"mt-6 p-4 bg_[var(--neutral-100)] rounded_[10px]",children:s.jsx("p",{className:"text-[13px] text_[var(--black-300)]",children:"ğŸ’¡ í™”ìƒ í†µí™”ë¥¼ ìœ„í•´ì„œëŠ” ìµœì†Œ 2Mbps ì´ìƒì˜ ì¸í„°ë„· ì†ë„ê°€ í•„ìš”í•©ë‹ˆë‹¤. ëª¨ë“  í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•´ì•¼ ì›í™œí•œ í™”ìƒ í†µí™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤."})})]})]})}),s.jsx("div",{className:"px-6 pb-8",children:s.jsx("div",{className:"max-w-md mx-auto",children:"idle"===b&&"idle"===f&&"idle"===p&&"idle"===N?s.jsxs(t,{onClick:G,className:"w-full",variant:"primary",children:[s.jsx(o,{className:"w-5 h-5 mr-2"}),"ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹œì‘"]}):K?s.jsx(t,{onClick:()=>v("/session/video-room"),className:"w-full",variant:"success",children:"í™”ìƒ ì„¸ì…˜ ì‹œì‘í•˜ê¸°"}):s.jsxs("div",{className:"space-y-3",children:[s.jsx(t,{onClick:G,className:"w-full",variant:"secondary",children:"ë‹¤ì‹œ í…ŒìŠ¤íŠ¸"}),("testing"===b||"testing"===f||"testing"===p||"testing"===N)&&s.jsx("p",{className:"text-center text-[14px] text-[#929292]",children:"í…ŒìŠ¤íŠ¸ ì§„í–‰ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”"})]})})})]})})}export{v as default};
